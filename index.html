<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="PasswordGeneratorFavicon.png" type="image/x-icon">
</head>

<body>
    <div class="content">
        <img src="PasswordGeneratorLogo.png" class="logo">
        <div class="generator">
            <p class="heading">Почему наш генератор паролей?</p>
            <ul class="why-our-password-generator">
                <li>Мы не воруем ваш сгенерированный пароль</li>
                <li>Наш генератор паролей генерирует безопасные пароли</li>
                <li>У нас куча настроек чтобы сгенерировать пароль который вам нужен</li>
            </ul>
            <p class="text">Ваш пароль: <input type="text" id="passwd" readonly></p>
            <div class="passwd-buttons">
                <button class="button" onclick="passwdGen()">Сгенерировать пароль</button>
                <button class="button button-with-image" onclick="openSettings()"></button>
                <button onclick="copyPasswd()" class="button">Скопировать пароль</button>
            </div>
            <div class="password-settings" id="password-settings" style="display: none">
                <p class="heading">Настройки пароля:</p>
                <p class="warning">Внимание: Настройки пароля по умолчанию делают ваш пароль более безопасным.</p>
                <ul class="settings-list">
                    <li>
                        <input type="checkbox" name="special-symbols-setting" id="special-symbols-setting">
                        <label class="btn" for="special-symbols-setting">Специальные символы (@, #, $, %)</label>
                    </li>
                    <li>
                        <input type="checkbox" name="read-password-setting" id="read-password-setting">
                        <label class="btn" for="read-password-setting">Читаемый пароль</label>
                    </li>
                    <li>
                        <input id="symbols-count" onchange="changeSymbolCount()" type="range" max="32" min="8" value="10">
                        <label for="quantity-symbols-in-password-setting">Количество символов в пароле: <span id="symbols">10</span></label>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        function changeSymbolCount() {
            let count = document.querySelector("#symbols-count").value;
            document.querySelector("#symbols").innerHTML = count;
        }

        window.onload = setInterval(function() {
            changeSymbolCount()
            document.querySelector('#passwd').style.width = document.querySelector("#symbols-count").value * 13 + "px";
        }, 10)

        function passwdGen() {
            let passwordSymbols = ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", 0, 1, 2, 3, 4, 5, 6, 7, 8, 9];
            let specialSymbols = ["!", "@", "#", "$", "%", "^", "&", "*", "(", ")", "-", "_", "+", "=", ";", ":", ",", "/", "?", "\\", "|", "`", "~", "[", "]", "{", "}", "."];
            let count = document.querySelector("#symbols-count").value;
            let passwd = '';

            if (document.querySelector("#special-symbols-setting").checked == true) {
                passwordSymbols = passwordSymbols.concat(specialSymbols);
                console.log(passwordSymbols);
            }
            if (document.querySelector("#read-password-setting").checked == true) {
                passwordSymbols.splice(passwordSymbols.indexOf("l"), 1);
                passwordSymbols.splice(passwordSymbols.indexOf(0), 1);
                passwordSymbols.splice(passwordSymbols.indexOf("i"), 1);
                passwordSymbols.splice(passwordSymbols.indexOf("o"), 1);
                console.log(passwordSymbols);
            }
            for (i = 0; i < count; i++) {
                let symbol = passwordSymbols[getRandomIntInclusive(0, passwordSymbols.length - 1)]
                    // while (passwd.indexOf(symbol) > 0) {
                    //     symbol = passwordSymbols[getRandomIntInclusive(0, passwordSymbols.length - 1)]
                    // }
                getRandomIntInclusive(1, 2);
                if (typeof symbol == "string") {
                    if (getRandomIntInclusive(1, 2) == 1) {
                        symbol = symbol.toUpperCase();
                    } else {
                        symbol = symbol.toLowerCase();
                    }
                }
                passwd += symbol;
            }
            document.querySelector("#passwd").value = passwd;
        }

        function getRandomIntInclusive(min, max) {
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function copyPasswd() {
            text = document.querySelector("#passwd")
            text.select();
            document.execCommand("copy")
        }

        function openSettings() {
            element = document.querySelector("#password-settings");
            if (element.style.display == "none") {
                element.style.display = "block";
            } else {
                element.style.display = "none";
            }
        }
    </script>
</body>

</html>